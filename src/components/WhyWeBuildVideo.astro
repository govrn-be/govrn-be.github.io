---
import { Image } from 'astro:assets';
import whyGovrnImg from '../assets/why-govrn.png';
import govrnLogoBg from '../assets/images/govrn-logo-blue.png';

interface WhyWeBuildVideoProps {
  title?: string;
  subtitle?: string;
  videoId?: string;
  description?: string;
  language?: string;
}

const {
  title = "Why We Build Govrn",
  subtitle = "Our Mission",
  videoId = "D6vubHkS_is",
  description = "Discover the story behind Govrn and why we're passionate about transforming board management with AI-powered solutions.",
  language = "en"
} = Astro.props;
---

<section class="relative py-24 bg-white logo-texture">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <p class="text-primary font-semibold text-lg tracking-wide uppercase mb-4">
        {subtitle}
      </p>
      <h2 class="text-4xl lg:text-5xl font-extrabold text-gray-900 tracking-tight mb-6">
        {title}
      </h2>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        {description}
      </p>
    </div>

    <div class="relative max-w-5xl mx-auto">
      <div class="relative aspect-video rounded-2xl overflow-hidden shadow-2xl bg-gray-900">
        <!-- Video thumbnail -->
        <div id="videoThumbnail" class="absolute inset-0">
          <Image
            src={whyGovrnImg}
            alt="Why We Build Govrn Video Thumbnail"
            class="w-full h-full object-cover"
            widths={[400, 800, 1280]}
            sizes="(max-width: 640px) 100vw, (max-width: 1024px) 80vw, 1280px"
          />

          <!-- Play button overlay -->
          <div class="absolute inset-0 flex items-center justify-center bg-black/20">
            <button
              id="playButton"
              class="group relative flex items-center justify-center w-20 h-20 bg-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110"
              aria-label="Play video"
            >
              <svg class="w-8 h-8 text-primary ml-1 group-hover:text-primary/80 transition-colors" fill="currentColor" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
              </svg>
              <div class="absolute inset-0 rounded-full bg-primary/10 animate-ping"></div>
            </button>
          </div>
        </div>

        <!-- YouTube iframe (hidden initially) -->
        <iframe
          id="youtubeIframe"
          class="absolute inset-0 w-full h-full hidden"
          title="Why We Build Govrn"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen
        ></iframe>
      </div>

      <!-- Floating elements for visual appeal -->
      <div class="absolute -top-6 -left-6 w-12 h-12 bg-primary/10 rounded-full blur-xl"></div>
      <div class="absolute -bottom-6 -right-6 w-16 h-16 bg-primary/5 rounded-full blur-xl"></div>
    </div>

  </div>
</section>

<script define:vars={{ videoId, language }}>
  document.addEventListener('DOMContentLoaded', function() {
    const playButton = document.getElementById('playButton');
    const thumbnail = document.getElementById('videoThumbnail');
    const iframe = document.getElementById('youtubeIframe');

    if (playButton && thumbnail && iframe) {
      playButton.addEventListener('click', function() {
        // Hide thumbnail
        thumbnail.style.display = 'none';

        // Configure subtitles based on language
        let ccParams = '';
        if (language === 'fr') {
          ccParams = '&cc_load_policy=1&cc_lang_pref=fr';
        } else if (language === 'nl') {
          ccParams = '&cc_load_policy=1&cc_lang_pref=nl';
        } else {
          ccParams = '&cc_load_policy=1&cc_lang_pref=en';
        }

        // Set iframe source with appropriate subtitles and show it
        iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1${ccParams}`;
        iframe.classList.remove('hidden');
      });
    }
  });
</script>


