---
import Layout from "../layouts/Layout.astro";
import governanceSummitImage from "../assets/governance_summit.png";
import { getCallSummaryById } from "../utils/callSummaries";
import { marked } from 'marked';

// Define types for our session objects
interface ParallelSession {
  title: string;
  speaker: string;
  summary: string;
  callId: string;
  language?: string;
  summaryHtml?: string | Promise<string>;
}

interface ProgramSession {
  time: string;
  startTime: string;
  endTime: string;
  title: string;
  speakers?: string[];
  type: string;
  summary?: string;
  callId?: string;
  language?: string;
  sessions?: ParallelSession[];
  summaryHtml?: string | Promise<string>;
}

const pageTitle = "Governance Summit 2025 - Program & Summaries";
const pageDescription = "Access the complete program and detailed summaries from the Governance Summit 2025. Comprehensive coverage of all sessions and speakers.";

// Pre-compute summaries for all sessions
const programSessions: ProgramSession[] = [
  {
    time: "09:15 - 09:30",
    startTime: "09:15",
    endTime: "09:30",
    title: "Welkomstwoord & Introductie",
    speakers: ["Hanne Decoutere (5 min)", "Philip Peeters (10 min)"],
    type: "opening",
    callId: "0eba087b-86ee-495d-83f6-b522691f960f",
    summary: ""
  },
  {
    time: "09:30 - 10:20",
    startTime: "09:30",
    endTime: "10:20",
    title: "Disaster in the boardroom, 6 disfunctions everybody should know",
    speakers: ["Randall Petersson"],
    type: "keynote",
    language: "EN",
    summary: getCallSummaryById("0eba087b-86ee-495d-83f6-b522691f960f") || "",
    callId: "0eba087b-86ee-495d-83f6-b522691f960f",
    summaryHtml: marked.parse(getCallSummaryById("0eba087b-86ee-495d-83f6-b522691f960f") || "")
  },
  {
    time: "10:20 - 11:05",
    startTime: "10:20",
    endTime: "11:05",
    title: "Parallelle Sessie I",
    speakers: ["Verschillende sprekers"],
    type: "parallel",
    sessions: [
      {
        title: "Waar staan minderheidsaandeelhouders vandaag in België?",
        speaker: "Michael Freilich",
        callId: "3",
        summary: ""
      },
      {
        title: "Staat inclusie onder druk? Een historische reflex",
        speaker: "Lieve Creten, Marie Bellefroid",
        callId: "4",
        summary: ""
      },
      {
        title: "Boardroom blind spots: CEO te snel gekozen, te lang gehouden",
        speaker: "Hilde Vanderschelden, Caroline De Clerck en Kurt Keirsmakers",
        callId: "5",
        summary: ""
      },
      {
        title: "Cybersecurity boardgame – ACEN",
        speaker: "ACEN Team",           
        callId: "6",
        summary: ""
      }
    ]
  },
  {
    time: "11:05 - 11:40",
    startTime: "11:05",
    endTime: "11:40",
    title: "Koffiemoment",
    type: "break"
  },
  {
    time: "11:40 - 12:10",
    startTime: "11:40",
    endTime: "12:10",
    title: "Panelgesprek: Hoe krijg je goede vibes in the boardroom?",
    speakers: ["Hanne Decoutere", "Bart De Smet", "Christ'l Joris"],
    type: "panel",
    callId: "7",
    summary: ""
  },
  {
    time: "12:10 - 13:00",
    startTime: "12:10",
    endTime: "13:00",
    title: "Parallelle Sessie II",
    speakers: ["Verschillende sprekers"],
    type: "parallel",
    sessions: [
      {
        title: "The corporate secretary is a DJ",
        speaker: "Kristof Macours, Vincent Pacheco",
        language: "EN",
        callId: "8",
        summary: ""
      },
      {
        title: "Governance is dood, leve de Governance",
        speaker: "Koen Hendrix, Hans Wilmots, Patrick Torfs, Jo Hendrikx en Wim Voordeckers",
        callId: "9",
        summary: ""
      },
      {
        title: "Is goed bestuur goed genoeg om als onderneming de maatschappelijke verandering aan te gaan?",
        speaker: "Ilse Balis, Marleen Denef",
        callId: "10",
        summary: ""
      },
      {
        title: "Cybersecurity boardgame – ACEN",
        speaker: "ACEN Team",
        callId: "11",
        summary: ""
      }
    ]
  },
  {
    time: "13:00 - 14:00",
    startTime: "13:00",
    endTime: "14:00",
    title: "Walking Lunch",
    type: "break"
  },
  {
    time: "14:00 - 14:50",
    startTime: "14:00",
    endTime: "14:50",
    title: "Nature-related issues factored into board decision making",
    speakers: ["Brontie Ansell (Keynote)", "Anouk Schoors (The Nest)", "Vanessa Van Bergen (Chapter Zero)"],
    type: "keynote-panel",
    language: "EN",
    callId: "12",
    summary: ""
  },
  {
    time: "14:50 - 15:40",
    startTime: "14:50",
    endTime: "15:40",
    title: "Parallelle Sessie III",
    speakers: ["Verschillende sprekers"],
    type: "parallel",
    sessions: [
      {
        title: "Cyberaanvallen treffen zowel u als uw bedrijf",
        speaker: "William Rosenhek",
        callId: "13",
        summary: ""
      },
      {
        title: "De governance scorecard voor familiebedrijven",
        speaker: "Laura Lannoo, Jozef Lievens",
        callId: "14",
        summary: ""
      },
      {
        title: "De board kan innovatie maken of kraken",
        speaker: "Robin De Cock, Lieven Danneels",
        callId: "15",
        summary: ""
      },
      {
        title: "Cybersecurity boardgame – ACEN",
        speaker: "ACEN Team",
        callId: "16",
        summary: ""
      }
    ]
  },
  {
    time: "15:40 - 16:15",
    startTime: "15:40",
    endTime: "16:15",
    title: "Koffiemoment",
    type: "break"
  },
  {
    time: "16:15 - 16:50",
    startTime: "16:15",
    endTime: "16:50",
    title: "Panelgesprek: De evolutie van governance in transitietrajecten",
    speakers: ["Philippe Craninx", "Christine De Dijcker", "Marc Van Hool"],
    type: "panel",
    callId: "17",
    summary: ""
  },
  {
    time: "16:50 - 17:45",
    startTime: "16:50",
    endTime: "17:45",
    title: "Het belang van het ongezegde in de bestuurskamer",
    speakers: ["Marilieke Engbers", "Sophie Buysse (Debateville)", "Sofie Pollet (IAA)", "Saartje Verbeke (GUBERNA)"],
    type: "keynote-panel",
    callId: "18",
    summary: ""
  },
  {
    time: "17:45 - 18:05",
    startTime: "17:45",
    endTime: "18:05",
    title: "Intermezzo",
    type: "break"
  },
  {
    time: "18:05 - 18:30",
    startTime: "18:05",
    endTime: "18:30",
    title: "Toespraak Eerste Minister",
    speakers: ["Bart De Wever, Eerste minister van België"],
    type: "keynote",
    callId: "19",
    summary: ""
  },
  {
    time: "18:30 - 18:40",
    startTime: "18:30",
    endTime: "18:40",
    title: "Takeaways van de summit",
    speakers: ["Bart De Smet, voorzitter Governance Summit"],
    type: "closing",
    callId: "20",
    summary: ""
  },
  {
    time: "18:40 - late",
    startTime: "18:40",
    endTime: "23:59",
    title: "Good vibes receptie",
    type: "networking",
    callId: "21",
    summary: ""
  }
]
---

<Layout 
  title={pageTitle}
  description={pageDescription}
  noindex={true}
>
  <main>
    <!-- Header Section -->
    <section class="relative bg-gradient-to-br from-white to-gray-50 pt-20 pb-16">
      <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_right,rgba(57,153,222,0.1),transparent_50%)]"></div>
      
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Logo and Title -->
        <div class="text-center mb-12">
          <div class="inline-block bg-white rounded-2xl p-6 shadow-xl border border-gray-100 mb-6">
            <img 
              src={governanceSummitImage.src} 
              alt="Governance Summit 2025" 
              class="max-w-md w-full h-auto"
            />
          </div>
          <h1 class="text-4xl font-bold text-gray-900 mb-4">
            Volledig Programma & Samenvattingen
          </h1>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Toegang tot het complete programma en gedetailleerde samenvattingen van België's eerste Governance Summit, 
            <strong>geanalyseerd door Govrn's intelligente platform</strong>
          </p>
        </div>
      </div>
    </section>

    <!-- Program Sessions -->
    <section class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-4">
            Vrijdag 6 juni, 2025 - Live Programma
          </h2>
          <p class="text-gray-600">
            Real-time status updates en sessie samenvattingen
          </p>
        </div>

        <div class="space-y-6">
          {programSessions.map((session, index) => (
            <div class={`rounded-2xl border shadow-lg overflow-hidden ${
              session.type === 'break' || session.type === 'networking' 
                ? 'bg-gray-50 border-gray-200' 
                : 'bg-white border-gray-200'
            }`} data-session-start={session.startTime} data-session-end={session.endTime}>
              <div class="p-6">
                <div class="flex flex-col lg:flex-row lg:items-start gap-6">
                  <!-- Time and Status -->
                  <div class="lg:w-48 flex-shrink-0">
                    <div class={`rounded-lg p-4 text-center ${
                      session.type === 'break' || session.type === 'networking'
                        ? 'bg-gray-200'
                        : 'bg-primary/10'
                    }`}>
                      <div class={`text-lg font-bold ${
                        session.type === 'break' || session.type === 'networking'
                          ? 'text-gray-600'
                          : 'text-primary'
                      }`}>
                        {session.time}
                      </div>
                      
                      <!-- Dynamic Status Badge -->
                      <div class="mt-3 session-status" data-session-start={session.startTime} data-session-end={session.endTime}>
                        <!-- Will be populated by JavaScript -->
                      </div>
                      
                      {session.language && (
                        <div class="mt-2 text-xs text-gray-500 font-medium">
                          [{session.language}]
                        </div>
                      )}
                    </div>
                  </div>

                  <!-- Content -->
                  <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">
                      {session.title}
                    </h3>
                    
                    {session.speakers && (
                      <p class="text-primary font-medium mb-4">
                        {session.speakers.join(' • ')}
                      </p>
                    )}
                    
                    <!-- Session Content -->
                    <div class="session-content" 
                      data-session-start={session.startTime} 
                      data-session-end={session.endTime} 
                      data-call-id={session.callId}>
                      {/* Handle parallel sessions */}
                      {session.type === 'parallel' && session.sessions ? (
                        <div class="space-y-4">
                          <h4 class="font-semibold text-gray-900 mb-4 text-lg">Parallelle Sessies:</h4>
                          {session.sessions.map((parallelSession, idx) => (
                            <div class="bg-gradient-to-r from-gray-50 to-white rounded-xl p-4 border border-gray-200">
                              <div class="flex items-start justify-between mb-3">
                                <div class="flex-1">
                                  <h5 class="font-bold text-gray-900 mb-1">
                                    {parallelSession.title}
                                    {parallelSession.language && (
                                      <span class="ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">
                                        {parallelSession.language}
                                      </span>
                                    )}
                                  </h5>
                                  <p class="text-primary font-medium text-sm">{parallelSession.speaker}</p>
                                </div>
                              </div>
                              
                              <!-- Summary Content -->
                              <div class="parallel-session-content">
                                {parallelSession.summaryHtml && (
                                  <div class="bg-white rounded-lg border border-gray-100">
                                    <!-- Accordion Header -->
                                    <button 
                                      class="w-full px-4 py-3 text-left flex items-center justify-between hover:bg-gray-50 transition-colors rounded-lg"
                                      data-accordion-button
                                    >
                                      <span class="text-sm font-medium text-gray-900">Read the summary</span>
                                      <svg class="w-4 h-4 text-gray-500 transform transition-transform accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                      </svg>
                                    </button>
                                    
                                    <!-- Accordion Content -->
                                    <div class="accordion-content px-4 pb-4" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-in-out;">
                                      <article class="govrn-summary prose prose-sm max-w-none text-gray-700" set:html={parallelSession.summaryHtml} />
                                    </div>
                                  </div>
                                )}
                              </div>
                            </div>
                          ))}
                        </div>
                      ) : (
                        /* Regular session summary */
                        session.summaryHtml && (
                          <div class="bg-white rounded-lg border border-gray-100">
                            <!-- Accordion Header -->
                            <button 
                              class="w-full px-4 py-3 text-left flex items-center justify-between hover:bg-gray-50 transition-colors rounded-lg"
                              data-accordion-button
                            >
                              <span class="text-sm font-medium text-gray-900">Read the summary</span>
                              <svg class="w-4 h-4 text-gray-500 transform transition-transform accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                              </svg>
                            </button>
                            
                            <!-- Accordion Content -->
                            <div class="accordion-content px-4 pb-4" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-in-out;">
                              <article class="govrn-summary prose prose-sm max-w-none text-gray-700" set:html={session.summaryHtml} />
                            </div>
                          </div>
                        )
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Call to Action -->
    <section class="py-16 bg-gradient-to-br from-primary to-blue-600">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl font-bold text-white mb-4">
        Transform Your Board Meetings into Strategic Powerhouses
        </h2>
        <p class="text-xl text-blue-100 mb-8">
          Discover how Govrn's AI-powered platform can enhance your board's effectiveness
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="/try" 
            class="inline-flex items-center gap-2 px-8 py-4 bg-white text-primary rounded-lg hover:bg-gray-50 transition-colors font-medium"
          >
            <span>Try Govrn Platform</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
            </svg>
          </a>
          <a 
            href="/request-demo" 
            class="inline-flex items-center gap-2 px-8 py-4 bg-transparent border-2 border-white text-white rounded-lg hover:bg-white hover:text-primary transition-colors font-medium"
          >
            <span>Request Demo</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
            </svg>
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style is:global>
  /* Custom scrollbar for better UX */
  .overflow-auto::-webkit-scrollbar {
    width: 6px;
  }
  
  .overflow-auto::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 3px;
  }
  
  .overflow-auto::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
  }
  
  .overflow-auto::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
  }

  /* Live indicator animation */
  @keyframes ping {
    75%, 100% {
      transform: scale(2);
      opacity: 0;
    }
  }
  
  .animate-ping {
    animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
  }
  
  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }
  
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: .5;
    }
  }

  /* Accordion animations */
  .accordion-content {
    overflow: hidden;
    transition: max-height 0.3s ease-in-out;
    max-height: 0;
  }
  
  [data-accordion-button] {
    @apply flex justify-center items-center w-full px-6 py-3 mb-2 rounded-lg bg-primary/10 text-primary font-semibold text-base shadow-sm transition-all duration-200 cursor-pointer;
    border: none;
    outline: none;
    margin: 0 auto;
  }
  [data-accordion-button]:hover, [data-accordion-button]:focus {
    @apply bg-primary text-white shadow-lg scale-105;
  }
  [data-accordion-button] .accordion-icon {
    @apply ml-2 transition-transform duration-200;
  }

  /* Enhanced HTML content styling */
  .prose {
    @apply text-gray-700 leading-relaxed;
  }

  .prose h3, .prose :where(h3) {
    color: #2563eb !important;
    background: linear-gradient(to right, #2563eb11, transparent);
    border-bottom: 2px solid #2563eb22;
    font-weight: bold;
    font-size: 1.25rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem 0.5rem 0 0;
  }

  .prose :where(ol) {
    @apply list-decimal pl-6 mb-6 space-y-4;
  }

  .prose :where(ol li) {
    @apply text-base relative;
  }

  .prose :where(ol li p) {
    @apply mb-2;
  }

  .prose :where(strong) {
    @apply font-semibold text-primary;
  }

  .prose :where(p) {
    @apply mb-4 text-base leading-relaxed;
  }

  .prose :where(blockquote) {
    @apply pl-4 border-l-4 border-primary/30 italic text-gray-600 my-6 bg-primary/5 p-4 rounded-r-lg;
  }

  /* Accordion content specific styles */
  .accordion-content .prose {
    @apply py-4;
  }

  .accordion-content .prose > *:first-child {
    @apply mt-0;
  }

  .accordion-content .prose > *:last-child {
    @apply mb-0;
  }

  /* Additional styles for better readability */
  .prose :where(h1, h2, h3, h4) {
    @apply scroll-mt-20;
  }

  .prose :where(ul, ol) {
    @apply my-6;
  }

  .prose :where(li) {
    @apply my-2;
  }

  .prose :where(hr) {
    @apply my-8 border-t-2 border-primary/20;
  }

  .prose :where(table) {
    @apply w-full border-collapse my-6;
  }

  .prose :where(th) {
    @apply bg-primary/10 text-left p-3 border border-primary/20 font-semibold;
  }

  .prose :where(td) {
    @apply p-3 border border-primary/20;
  }

  .prose :where(tr:nth-child(even)) {
    @apply bg-primary/5;
  }

  .prose :where(img) {
    @apply rounded-lg my-4 shadow-lg;
  }

  /* Custom styles for specific sections */
  .prose :where(h3 + p) {
    @apply text-gray-600 italic;
  }

  .prose :where(h3 + ol) {
    @apply mt-4;
  }

  .prose :where(h3 + ol li) {
    @apply bg-white p-4 rounded-lg border border-gray-100 shadow-sm;
  }

  .prose :where(h3 + ol li strong) {
    @apply block text-primary mb-2;
  }

  .govrn-summary h3, .govrn-summary h4 {
    @apply text-primary font-semibold;
    font-size: 1.1rem;
    background: none;
    border: none;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    padding: 0;
    border-radius: 0;
  }

  .govrn-summary {
    @apply bg-white rounded-xl p-4 border border-gray-100;
  }

  .govrn-summary p {
    @apply text-gray-700 leading-relaxed mb-3;
  }

  .govrn-summary ul, .govrn-summary ol {
    @apply my-2;
    padding-left: 1.2em;
  }

  .govrn-summary li {
    @apply bg-transparent p-0 rounded-none border-0;
  }

  .govrn-summary blockquote {
    @apply bg-gray-50 border-l-4 border-primary p-3 rounded-r-lg my-3;
  }

  .govrn-summary blockquote p {
    @apply text-gray-700 italic mb-0;
  }

  .govrn-summary code {
    @apply bg-gray-100 px-1 py-0.5 rounded text-sm font-mono;
  }

  .govrn-summary pre {
    @apply bg-gray-100 p-3 rounded-lg overflow-x-auto my-3;
  }

  .govrn-summary pre code {
    @apply bg-transparent p-0;
  }

  .govrn-summary table {
    @apply w-full border-collapse my-3;
  }

  .govrn-summary th {
    @apply bg-gray-50 text-left p-2 border border-gray-200 font-semibold;
  }

  .govrn-summary td {
    @apply p-2 border border-gray-200;
  }

  .govrn-summary tr:nth-child(even) {
    @apply bg-gray-50;
  }

  .govrn-summary a {
    @apply text-primary hover:text-blue-700 underline;
  }

  .govrn-summary img {
    @apply rounded-lg my-3 shadow-sm max-w-full h-auto;
  }

  .govrn-summary hr {
    @apply my-4 border-t border-gray-100;
  }

  .govrn-summary .highlight {
    @apply bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-r-lg my-3;
  }

  .govrn-summary .key-points {
    @apply bg-blue-50 rounded-lg p-3 my-3;
  }

  .govrn-summary .key-points h4 {
    @apply text-primary font-semibold mb-2;
  }

  .govrn-summary .key-points ul {
    @apply space-y-1;
  }

  .govrn-summary .key-points li {
    @apply bg-white p-2 rounded-lg border border-blue-100;
  }
</style>

<script>
  // Initialize all accordions
  document.addEventListener('DOMContentLoaded', () => {
    const accordionButtons = document.querySelectorAll('[data-accordion-button]');
    
    accordionButtons.forEach(button => {
      const content = button.nextElementSibling as HTMLElement;
      if (content) {
        content.style.maxHeight = '0px';
      }

      button.addEventListener('click', () => {
        const content = button.nextElementSibling as HTMLElement;
        const icon = button.querySelector('.accordion-icon') as HTMLElement;
        
        if (content.style.maxHeight === '0px' || !content.style.maxHeight) {
          content.style.maxHeight = `${content.scrollHeight}px`;
          icon.style.transform = 'rotate(180deg)';
        } else {
          content.style.maxHeight = '0px';
          icon.style.transform = 'rotate(0deg)';
        }
      });
    });
  });
</script> 